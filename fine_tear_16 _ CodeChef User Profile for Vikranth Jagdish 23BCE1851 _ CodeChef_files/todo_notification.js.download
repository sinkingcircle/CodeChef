$(document).ready(function(){setupTodos(true)});var todosCache={};function setupTodos(o){var t=$(".notification-listbox");var e="";if($("#todo-notification-icon").length==0){e=".todo-section i, .todo-section .notification-counter"}else{e=".notification-box-todo>#todo-notification-icon, .notification-box-todo>.notification-counter"}$(e).click(function(o){if(t.is(":hidden")){t.show();show_todo_notification(t)}else{hide_todo_notification(t)}o.preventDefault()});$(document).keyup(function(o){if(o.keyCode==27){hide_todo_notification(t)}})}function show_todo_notification(o){if($(".notification-listbox-head").length>0){$(".notification-listbox-head").after('<div class="notification-listbox-loader"></div>')}setTimeout(function(){$.ajax({url:"/todo/notification?v="+Date.now(),type:"GET",dataType:"json",success:function(t){var e=t.count;o.empty().html(t.html)},error:function(t,e,i){o.empty().append("Sorry your Todo list can not be rendered.")}})},1e3)}function hide_todo_notification(o){o.hide()}function widget_add_todo(o,t,e){var i=o.target;$.ajax({type:"POST",url:"/api/todo/add",headers:{"x-csrf-token":window.csrfToken},dataType:"json",data:{pcode:t,ccode:e}}).done(function(o){if(typeof $.growl==="function"){$.growl({title:"Success",message:o.message})}else{$($(i).next(".todo-button-message")[0]).html(o.message)}$(i).prop("src","https://cdn.codechef.com/sites/all/themes/abessive/images/add2.png");$(i).prop("title","Problem already present in Todo list");incrementNotifCouter()}).fail(function(o){var t=JSON.parse(o.responseText);if(typeof $.growl==="function"){$.growl({title:"Error",message:t.message})}else{$($(i).next(".todo-button-message")[0]).html(t.message)}})}function incrementNotifCouter(){var o=$(".notification-counter").html();if(o===""){$(".notification-counter").html(1);todosCache.result={};todosCache.result.count=1}else{$(".notification-counter").html(parseInt(o)+1);todosCache.result.count++}}function decrementNotifCouter(){var o=$(".notification-counter").html();$(".notification-counter").html(parseInt(o)-1)}function setNotifCounter(o){$(".notification-counter").html(parseInt(o))}